<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <style>
        /* Add your CSS styles here */
        body {
            font-family: Arial, sans-serif;
        }

        .dashboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .section {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            padding: 20px;
            margin: 10px;
            width: calc(33.33% - 20px);
        }

        h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .event {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
        }

        .event img {
            max-width: 100%;
            height: auto;
        }

        .paid {
            background-color: #4CAF50;
            color: white;
        }

        .pending {
            background-color: #FFC107;
            color: white;
        }

        .unpaid {
            background-color: #F44336;
            color: white;
        }
    </style>
</head>
<body>
<a th:href="@{/perform_logout}">Sign Out</a>
<div class="dashboard">

  <!-- User Search Form -->
  <form action="/user-search">
    <fieldset>
      <legend>Find Users</legend>

      <label for="username">Username:</label>
      <input type="text" name="username" id="username">

      <input type="submit" value="Search">
    </fieldset>
  </form>

  <!-- Event Search Form -->
  <form action="/event-search">
    <fieldset>
      <legend>Find Events</legend>

      <label for="eventName">Event:</label>
      <input type="text" name="eventName" id="eventName">

      <input type="submit" value="Search">
    </fieldset>
  </form>
  <!-- End Of Event Search Form -->



  <!-- Most Booked User -->
  <div class="section">
    <div th:if="${mostBookedEventName}">
    <h1>Most Booked Event</h1>
    <p><strong>Name:</strong> <span th:text="${mostBookedEventName}"></span></p>
    <p><strong>Total Bookings:</strong> <span th:text="${mostBookedEventCount}"></span></p>
  </div>

    <!-- Most Booked User -->
    <div th:if="${mostBookedUserName}">
      <h1>User with the Most Booked Events</h1>
      <p><strong>Name:</strong> <span th:text="${mostBookedUserName}"></span></p>
      <p><strong>Total Bookings:</strong> <span th:text="${mostBookedUserCount}"></span></p>
    </div>
  <div class="section">
      <h1>Total Incomes</h1>
    <p><strong>Total Incomes:</strong> <span th:text="${totalIncomes}"></span></p>
  </div>

  <div class="section">
    <h1>Booked Events</h1>
    <form action="/booked-events" method="get">
      <input type="submit" value="View All Booked Events">
    </form>
    <p th:if="${totalBookedEvents}"><strong>Total Booked Events:</strong> <span th:text="${totalBookedEvents}"></span></p>
    <p th:if="${totalBookedEvents}"><strong>Name:</strong> <span th:text="${mostBookedEventName}"></span></p>
    <p th:if="${totalBookedEvents}"><strong>Total Bookings:</strong> <span th:text="${mostBookedEventCount}"></span></p>
  </div>
  <div class="section">
    <h1>Payment Status</h1>
    <form action="/unpaid-events" method="get">
      <input type="submit" value="View Unpaid Events">
    </form>
    <form action="/pending-events" method="get">
      <input type="submit" value="View Pending Events">
    </form>
    <form action="/paid-events" method="get">
      <input type="submit" value="View Paid Events">
    </form>
        <div class="event paid">
          <h2>Paid Events</h2>
          <p><strong>Total Paid Events:</strong> <span th:text="${totalPaidEvents}"></span></p>
        </div>
        <div class="event pending">
          <h2>Pending Events</h2>
          <p><strong>Total Pending Events:</strong> <span th:text="${totalPendingEvents}"></span></p>
        </div>
        <div class="event unpaid">
          <h2>Unpaid Events</h2>
          <p><strong>Total Unpaid Events:</strong> <span th:text="${totalUnpaidEvents}"></span></p>
        </div>
      </div>
    </div>

    <!-- Render the list of events based on the selected tab -->
    <h1 th:if="${bookedEvents}">Booked Events</h1>
    <h1 th:if="${unpaidEvents}">Unpaid Events</h1>
    <h1 th:if="${pendingEvents}">Pending Events</h1>
    <h1 th:if="${paidEvents}">Paid Events</h1>


    <!-- Render the list of events -->
    <div th:each="event : ${bookedEvents}" th:if="${bookedEvents}">
      <div class="event">
        <p><strong>Booked by:</strong> <span th:text="${event.user.username}"></span></p>
        <h2 th:text="${event.name}"></h2>
        <p><strong>Start Date:</strong> <span th:text="${event.startDate}"></span></p>
        <p><strong>End Date:</strong> <span th:text="${event.endDate}"></span></p>
        <p><strong>URL:</strong> <a th:href="${event.url}" th:text="${event.url}"></a></p>
        <p><strong>Location:</strong> <span th:text="${event.location.name}"></span></p>
        <p><strong>Price:</strong> <span th:text="${event.price}"></span> <span th:text="${event.priceCurrency}"></span></p>
        <img th:src="${event.image}" alt="Event Image" width="200" height="150"/>
        <p><strong>Payment Status:</strong> <span th:text="${event.paymentStatus}"></span></p>
        <form th:action="@{'/update-event-status/' + ${event.id}}" method="post">
          <input type="submit" value="Change to Paid" />
        </form>
      </div>
    </div>
<div class="section">
  <h1>Most Booked Event</h1>
  <p><strong>Name:</strong> <span th:text="${mostBookedEventName}"></span></p>
  <p><strong>Total Bookings:</strong> <span th:text="${mostBookedEventCount}"></span></p>
</div>
<div class="section">
  <h1>The User with most booked events</h1>
  <p><strong>Name:</strong> <span th:text="${mostBookedUserName}"></span></p>
  <p><strong>Total Bookings:</strong> <span th:text="${mostBookedUserCount}"></span></p>
</div>
    <div th:each="event : ${unpaidEvents}" th:if="${unpaidEvents}">
      <div class="event">
        <p><strong>Booked by:</strong> <span th:text="${event.user.username}"></span></p>
        <h2 th:text="${event.name}"></h2>
        <p><strong>Start Date:</strong> <span th:text="${event.startDate}"></span></p>
        <p><strong>End Date:</strong> <span th:text="${event.endDate}"></span></p>
        <p><strong>URL:</strong> <a th:href="${event.url}" th:text="${event.url}"></a></p>
        <p><strong>Location:</strong> <span th:text="${event.location.name}"></span></p>
        <p><strong>Price:</strong> <span th:text="${event.price}"></span> <span th:text="${event.priceCurrency}"></span></p>
        <img th:src="${event.image}" alt="Event Image" width="200" height="150"/>
        <p><strong>Payment Status:</strong> <span th:text="${event.paymentStatus}"></span></p>
        <form th:action="@{'/update-event-status/' + ${event.id}}" method="post">
          <input type="submit" value="Change to Paid" />
        </form>
      </div></div>
    <div th:each="event : ${pendingEvents}" th:if="${pendingEvents}">
      <div class="event">
        <p><strong>Booked by:</strong> <span th:text="${event.user.username}"></span></p>
        <h2 th:text="${event.name}"></h2>
        <p><strong>Start Date:</strong> <span th:text="${event.startDate}"></span></p>
        <p><strong>End Date:</strong> <span th:text="${event.endDate}"></span></p>
        <p><strong>URL:</strong> <a th:href="${event.url}" th:text="${event.url}"></a></p>
        <p><strong>Location:</strong> <span th:text="${event.location.name}"></span></p>
        <p><strong>Price:</strong> <span th:text="${event.price}"></span> <span th:text="${event.priceCurrency}"></span></p>
        <img th:src="${event.image}" alt="Event Image" width="200" height="150"/>
        <p><strong>Payment Status:</strong> <span th:text="${event.paymentStatus}"></span></p>
        <form th:action="@{'/update-event-status/' + ${event.id}}" method="post">
          <input type="submit" value="Change to Paid" />
        </form>
      </div></div>
    <div th:each="event : ${paidEvents}" th:if="${paidEvents}">
      <div class="event">
        <p><strong>Booked by:</strong> <span th:text="${event.user.username}"></span></p>
        <h2 th:text="${event.name}"></h2>
        <p><strong>Start Date:</strong> <span th:text="${event.startDate}"></span></p>
        <p><strong>End Date:</strong> <span th:text="${event.endDate}"></span></p>
        <p><strong>URL:</strong> <a th:href="${event.url}" th:text="${event.url}"></a></p>
        <p><strong>Location:</strong> <span th:text="${event.location.name}"></span></p>
        <p><strong>Price:</strong> <span th:text="${event.price}"></span> <span th:text="${event.priceCurrency}"></span></p>
        <img th:src="${event.image}" alt="Event Image" width="200" height="150"/>
        <p><strong>Payment Status:</strong> <span th:text="${event.paymentStatus}"></span></p>
      </div>
    </div>
  </div>
</div>
</body>
</html>